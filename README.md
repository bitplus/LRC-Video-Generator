# 歌词视频生成器 LRC Video Generator (Web Version)

**一款强大而直观的工具，旨在将您的音乐、歌词和专辑封面无缝融合，创造出具有专业水准的卡拉OK或动态歌词视频。**

基于 **FastAPI** 和 **HTML5/CSS3** 构建，提供现代化的 Web 界面，无需安装复杂的 GUI 库，即可在任何支持现代浏览器的设备上使用。

**视频示例**:

  https://www.bilibili.com/video/BV1CxqBBzEjo/

[![Video Thumbnail](https://github.com/bitplus/LRC-Video-Generator/blob/assets/preview_7676179b-b953-4ef6-a4b9-a22288696b98.png)]([https://www.bilibili.com/video/BV1CxqBBzEjo/])

## ✨ 核心功能

### 🎨 视觉与动画
- **现代 Web 界面**: 清爽的暗色主题设计，操作流畅，响应迅速。
- **丰富的动画效果**:
  - **背景**: 内置“静态模糊”、“动态渐变波浪”等多种背景效果。
  - **歌词**: 支持“淡入淡出”、“滚动列表”等多种精美的歌词展示动画。
  - **封面**: 可选择“静态展示”或模拟“黑胶唱片旋转”效果。
- **智能色彩提取**: 自动从封面图片中提取最佳的主色、辅色和描边色，确保视频视觉风格统一。
- **音频可视化**: 在歌词下方动态显示**半透明的音频波形**，增加视觉动感。
- **信息叠加**: 自动在视频左下角显示**歌名、歌手**以及**动态播放时间** (例如 `00:15 / 03:45`)。

### 🛠️ 强大的控制
- **实时预览**: 在生成完整视频前，可拖动进度条预览任意时间点的静态画面，所见即所得。
- **元数据自动解析**: 自动从 LRC 文件中读取歌名和歌手信息，并支持手动修改。
- **工程化管理**: 支持将当前所有设置保存为项目文件 (`.json`)，方便随时存档和加载。
- **自定义字体**: 支持加载自定义字体文件 (`.ttf`, `.otf`)，满足个性化排版需求。

### ⚡ 高性能
- **硬件加速**: 支持 NVIDIA (NVENC)、AMD (AMF) 和 Intel (QSV) 硬件编码加速，大幅提升渲染速度。
- **异步处理**: 视频生成任务在后台异步执行，不阻塞界面操作。

## 📋 环境依赖

1. **[FFmpeg](https://ffmpeg.org/download.html)**: **必需项**。
   - 请下载并安装 FFmpeg，并将其路径添加到系统环境变量中。
   - 或者在软件界面的“高级设置”中指定路径。

2. **Python**: 推荐使用 3.10 或更高版本。

3. **Python 库**:
   ```bash
   pip install -r requirements.txt
   ```
   - **fastapi & uvicorn**: 构建高性能的 Web 后端服务，处理 API 请求和文件传输。
   - **python-multipart**: 用于处理文件上传（音频、图片、LRC）。
   - **aiofiles**: 实现异步文件读写，避免大文件操作阻塞服务器。
   - **Pillow (PIL)**: 用于图像处理（封面裁剪、缩放）和颜色分析。
   - **scikit-learn**: 使用 K-Means 聚类算法从封面中提取主色调。
   - **numpy**: 辅助进行高效的数值计算和图像数据处理。

4. **字体文件**:
   - 请将您希望在视频中使用的字体文件（如 `.ttf` 或 `.otf` 格式）放入程序根目录下的 `font` 文件夹中。

## 🚀 快速开始

1. **启动程序**: 
   在项目根目录下运行：
   ```bash
   python app.py
   ```
   或者使用 uvicorn (开发模式):
   ```bash
   python -m uvicorn app:app --reload --port 8000
   ```

2. **访问界面**: 
   程序启动后会自动在浏览器中打开 `http://127.0.0.1:8000`。

3. **使用流程**:
   - **上传文件**: 依次上传音频、封面图片和 LRC 歌词文件。
   - **确认信息**: 检查自动提取的歌名和歌手信息，如有需要可手动修改。
   - **调整样式**: 选择喜欢的动画效果、字体和颜色（可使用“从封面提取颜色”功能）。
   - **预览**: 拖动预览滑块并点击“生成预览”，确认画面效果。
   - **生成**: 点击“开始生成视频”，等待后台处理完成后下载成品。

## 📂 项目结构

```
LRC-Video-Generator/
├── app.py               # Web应用主入口 (FastAPI)
├── static/              # 前端资源
│   ├── index.html       # 页面结构
│   ├── style.css        # 页面样式
│   ├── script.js        # 页面逻辑
├── video_processor.py   # 核心视频处理模块 (FFmpeg 调用)
├── animations.py        # 动画滤镜定义
├── lrc_parser.py        # LRC 解析器
├── color_extractor.py   # 颜色提取模块
├── requirements.txt     # 依赖列表
└── font/                # 字体目录 (请放入您的字体文件)
```

## ⚠️ 注意事项

- 视频生成是一个计算密集型任务，建议在生成时尽量减少其他高负载操作。
- 如果生成失败，请检查界面下方的“日志输出”，通常包含详细的错误信息（如 FFmpeg 路径错误、内存不足等）。
- 确保 LRC 文件为标准的 UTF-8 编码格式，以避免乱码问题。

## ⚖️ 许可协议 (License)

### 软件源代码

本项目的源代码采用 **MIT License** 进行许可。详情请参阅项目根目录下的 `LICENSE` 文件。

### 生成的视频内容

使用本软件生成的视频内容默认采用 **知识共享署名 4.0 国际 (CC BY 4.0)** 许可协议。

这意味着，当您发布、分享或修改任何由本软件生成的视频时，您 **必须** 提供清晰、适当的署名。我们推荐您在视频简介或视频画面中包含以下文字：

> **视频使用“LRC Video Generator”制作，项目地址：[https://github.com/bitplus/LRC-Video-Generator]**

## 📝 免责声明 (Disclaimer)

1. **无保证**: 本软件按“原样”提供，不提供任何形式的明示或暗示的保证。作者或版权持有人不对任何人因使用本软件所产生的任何索赔、损害或其他责任负责。
2. **内容责任**: 用户在使用本软件时，应自行承担全部责任，确保所使用的所有素材（包括但不限于音频、封面图片、歌词文件等）均已获得合法的版权授权，或符合相关法律法规的合理使用规定。
3. **版权侵权**: 本软件仅作为一个工具，其开发者不对任何用户因使用本软件生成、发布、传播的内容所导致的版权侵权问题承担任何法律及连带责任。所有因内容版权产生的纠纷和后果，均由用户自行承担。
4. **使用风险**: 您明确同意，使用本软件的风险由您自行承担。

**请在使用本软件前，仔细阅读并理解以上声明。继续使用本软件，即表示您已同意并接受本许可协议及免责声明的全部内容。**
